<div class="form">

  <h1>Création de compte</h1>

  <form [formGroup]="form">

    <div class="form-group">

      <!-- Nom -->

      <section class="bigbox">

        <div class="box">

          <img src="assets/icons/user.png" alt="icon">

          <div class="input">

            <label for="lastname">Nom</label>

            <div class="form-control">
              <input type="text" name="lastname" placeholder="Nom" formControlName="lastname">
            </div>

          </div>

        </div>

        <div *ngIf="form.get('lastname')?.invalid && (form.get('lastname')?.dirty || form.get('lastname')?.touched)">

          <p *ngIf="form.get('lastname')?.hasError('required')" class="error">
            *Ce champs est requis.
          </p>

          <p *ngIf="form.get('lastname')?.hasError('invalidFormat')" class="error">
            *Première lettre en majuscule, <br> pas de caractères spéciaux <br> ni de chiffres.
          </p>

          <p *ngIf="form.get('lastname')?.hasError('maxlength')" class="error">
            *Maximum 20 caractères.
          </p>

        </div>

      </section>


      <!-- Prénom -->

      <section class="bigbox">

        <div class="box">

          <img src="assets/icons/user.png" alt="icon">

          <div class="input">

            <label for="firstname">Prénom</label>

            <div class="form-control">
              <input type="text" name="firstname" placeholder="Prénom" formControlName="firstname">
            </div>

          </div>

        </div>

        <div *ngIf="form.get('firstname')?.invalid && (form.get('firstname')?.dirty || form.get('firstname')?.touched)">

          <p *ngIf="form.get('firstname')?.hasError('required')" class="error">
            *Ce champs est requis.
          </p>

          <p *ngIf="form.get('firstname')?.hasError('invalidFormat')" class="error">
            *Première lettre en majuscule, <br> pas de caractères spéciaux <br> ni de chiffres.
          </p>

          <p *ngIf="form.get('firstname')?.hasError('maxlength')" class="error">
            *Maximum 20 caractères.
          </p>

        </div>

      </section>

      <!-- Pseudo -->

      <section class="bigbox">

        <div class="box">

          <img src="assets/icons/user.png" alt="icon">

          <div class="input">

            <label for="pseudo">Pseudo</label>

            <div class="form-control">
              <input type="text" name="pseudo" placeholder="Pseudo" formControlName="pseudo">
            </div>

          </div>

        </div>

        <div *ngIf="form.get('pseudo')?.invalid && (form.get('pseudo')?.dirty || form.get('pseudo')?.touched)">

          <p *ngIf="form.get('pseudo')?.hasError('required')" class="error">
            *Ce champs est requis.
          </p>

          <p *ngIf="form.get('pseudo')?.hasError('username')" class="error">
            *Pas de caractères spéciaux, pas d'espace.
          </p>

          <p *ngIf="form.get('pseudo')?.hasError('maxlength')" class="error">
            *Maximum 10 caractères.
          </p>

        </div>

      </section>

      <!-- Photo -->

      <section class="bigbox">

        <div class="box">

          <img src="assets/icons/picture.png" alt="icon">

          <div class="input">

            <label for="picture">Photo</label>

            <div class="form-control">

              <app-file-upload formControlName="picture"></app-file-upload>
              <!-- Mise en place du composant file-upload permettant de télécharger des photos.  -->

            </div>

          </div>

        </div>

        <div *ngIf="form.get('picture')?.invalid && (form.get('picture')?.dirty || form.get('picture')?.touched)">

          <p *ngIf="form.get('picture')?.hasError('invalidFileType')" class="error">
              *Formats JPEG et PNG seulement acceptés.
          </p>

        </div>

      </section>

      <!-- Ville -->

      <section class="bigbox">

        <div class="box">

          <img src="assets/icons/location.png" alt="icon">

          <div class="input">

            <label for="city">Ville</label>

            <div class="form-control">
              <input type="text" name="city" placeholder="Ville" formControlName="city">
            </div>

          </div>

        </div>

        <div *ngIf="form.get('city')?.invalid && (form.get('city')?.dirty || form.get('city')?.touched)">

          <p *ngIf="form.get('city')?.hasError('required')" class="error">
            *Ce champs est requis.
          </p>

          <p *ngIf="form.get('city')?.hasError('invalidFormat')" class="error">
            *Première lettre en majuscule, <br> pas de caractères spéciaux <br> ni de chiffres.
          </p>

        </div>

      </section>

      <!-- Code postal -->

      <section class="bigbox">

        <div class="box">

          <img src="assets/icons/location.png" alt="icon">

          <div class="input">

            <label for="county">Code postal</label>

            <div class="form-control">
              <input type="text" name="county" placeholder="Code postal" formControlName="county">
            </div>

          </div>

        </div>

        <div *ngIf="form.get('county')?.invalid && (form.get('county')?.dirty || form.get('county')?.touched)">

          <p *ngIf="form.get('county')?.hasError('required')" class="error">
            *Ce champs est requis.
          </p>

          <p *ngIf="form.get('county')?.hasError('numberOnly')" class="error">
            *Uniquement des chiffres.
          </p>

          <p *ngIf="form.get('county')?.hasError('minlength')" class="error">
            *Minimum 3 caractères.
          </p>

          <p *ngIf="form.get('county')?.hasError('maxlength')" class="error">
            *Maximum 5 caractères.
          </p>

        </div>

      </section>

      <!-- Email -->

      <section class="bigbox">

        <div class="box">

          <img src="assets/icons/mail.png" alt="icon">

          <div class="input">

            <label for="email">Email</label>

            <div class="form-control">
              <input type="mail" name="mail" placeholder="Email" formControlName="mail">
            </div>

          </div>

        </div>

        <div *ngIf="form.get('mail')?.invalid && (form.get('mail')?.dirty || form.get('mail')?.touched)">

          <p *ngIf="form.get('mail')?.hasError('required')" class="error">
            *Ce champs est requis.
          </p>

          <p *ngIf="form.get('mail')?.hasError('email')" class="error">
            *Renseigner une adresse mail valide.
          </p>

        </div>

      </section>

      <!-- Mot de passe -->

      <section class="bigbox">

        <div class="box">

          <img src="assets/icons/password.png" alt="icon">

          <div class="input">

            <label for="password">Mot de passe</label>

            <div class="form-control">
              <input type="password" name="password" placeholder="Mot de passe" formControlName="password">
            </div>

          </div>

        </div>

        <div *ngIf="form.get('password')?.invalid && (form.get('password')?.dirty || form.get('password')?.touched)">

          <p *ngIf="form.get('password')?.hasError('required')" class="error">
            *Ce champs est requis.
          </p>

          <p *ngIf="form.get('password')?.hasError('invalidPassword')" class="error">
            *Au moins une majuscule, <br> un caractère spécial et un chiffre.
          </p>

          <p *ngIf="form.get('password')?.hasError('minlength')" class="error">
            *Minimum 8 caractères.
          </p>

        </div>

      </section>

      <!-- Confirmation mot de passe -->

      <section class="bigbox">

        <div class="box">

          <img src="assets/icons/password.png" alt="icon">

          <div class="input">

            <label for="confirmation">Confirmer mot de passe</label>

            <div class="form-control">
              <input type="password" name="confirmation" placeholder="Confirmer mot de passe"
                formControlName="confirmation">
            </div>

          </div>

        </div>

        <div
          *ngIf="form.get('confirmation')?.invalid && (form.get('confirmation')?.dirty || form.get('confirmation')?.touched)">

          <p *ngIf="form.get('confirmation')?.hasError('required')" class="error">
            *Ce champs est requis.
          </p>

          <p *ngIf="form.get('confirmation')?.hasError('invalidPassword')" class="error">
            *Au moins une majuscule, <br> un caractère spécial et un chiffre.
          </p>

          <p *ngIf="form.get('confirmation')?.hasError('minlength')" class="error">
            *Minimum 8 caractères.
          </p>

          <p *ngIf="form.get('confirmation')?.hasError('passwordMismatch')" class="error">
            *Les mots de passe <br> ne correspondent pas.
          </p>

        </div>

      </section>

    </div>

  </form> 

  <div class="cgu">
    <input type="checkbox" [(ngModel)]="isChecked" [disabled]="form.invalid">
    <span>J'accepte les <a class="a" href='/cgu'>CGU</a>.</span>
  </div>

  <button class="form-btn" type="submit" (click)="onSubmitForm()" [disabled]="!isChecked">Créer mon compte</button>

</div>


<div class="window" *ngIf="registered">

  <h2>Félicitations !</h2>

  <img src="assets/icons/good.png" alt="smiley">

  <p>Votre compte utilisateur a été créé avec succès! Vous faites désormais parti de la communauté des trocoeurs!</p>

  <button [routerLink]="['/login']">Se connecter</button>

</div>


<div [ngClass]="{'disappear': close}">

  <div class="wrong" *ngIf="errorEmail">

    <h2>Formulaire non valide !</h2>

    <img src="assets/icons/bad.png" alt="smiley">

    <p>Votre adresse e-mail est déjà utilisée par un autre utilisateur.</p>

    <button (click)="closeBtn()">Revenir au formulaire</button>

  </div>

</div>


<div [ngClass]="{'disappear': close}">

  <div class="wrong" *ngIf="errorPseudo">

    <h2>Formulaire non valide !</h2>

    <img src="assets/icons/bad.png" alt="smiley">

    <p>Votre pseudo est déjà utilisé par un autre utilisateur.</p>

    <button (click)="closeBtn()">Revenir au formulaire</button>

  </div>

</div>
